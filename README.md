# Πλατφόρμα Κρατήσεων & Πληρωμών για Θεατρική Παράσταση

Αυτή η μικρή εφαρμογή (Streamlit) χρησιμοποιείται από τον Σύλλογο Γονέων & Κηδεμόνων
για τη διαχείριση κρατήσεων και πληρωμών για τη θεατρική παράσταση:

**«Ο κουρέας της Σεβίλλης»**  
Σάββατο 18 Ιανουαρίου 2025, 11:00

Η εφαρμογή επιτρέπει:

- στους γονείς να:
  - δουν πόσες θέσεις είναι ήδη δεσμευμένες / πληρωμένες,
  - δηλώσουν ή να ενημερώσουν τη συμμετοχή τους,
  - λάβουν κωδικό πληρωμής (για IRIS / Revolut / μετρητά),
  - μπουν σε λίστα αναμονής, αν δεν είχαν αρχικά δηλώσει ενδιαφέρον,
- στο Δ.Σ. να:
  - βλέπει πόσες θέσεις είναι paid / pending / waitlist,
  - μαρκάρει πληρωμές,
  - εξάγει όλα τα δεδομένα σε CSV.

Η υλοποίηση αναπτύχθηκε με βάση τον κώδικα του repository  
[**gfragi/book_seat_pay**](https://github.com/gfragi/book_seat_pay).

---

## Δομή project

Προτεινόμενη δομή φακέλων:

```text
project-root/
└── payments_app/
    ├── payments.py
    ├── logo_syllogos.png
    ├── requirements.txt
    └── data/
        ├── interest.csv
        └── payments.csv
payments.py: ο κώδικας του Streamlit app.

logo_syllogos.png: logo του Συλλόγου που εμφανίζεται στην κορυφή της σελίδας.

data/interest.csv: export από τη φόρμα ενδιαφέροντος (Google Form).

data/payments.csv: δημιουργείται και ενημερώνεται αυτόματα από την εφαρμογή.

Αρχείο interest.csv
Το interest.csv είναι export από το Google Form και πρέπει να έχει τις στήλες:

Timestamp

Email address

Ονοματεπώνυμο γονέα/κηδεμόνα

Τμήμα παιδιού/παιδιών

Αριθμός παιδικών εισιτηρίων

Αριθμός συνοδών ενηλίκων

Η εφαρμογή τα μετατρέπει εσωτερικά σε:

email

parent_name

child_class

child_tickets

adult_tickets

total_tickets

Οι γονείς που υπάρχουν στο interest.csv θεωρούνται ότι είχαν αρχικά δηλώσει ενδιαφέρον και έχουν προτεραιότητα μέχρι την προθεσμία πληρωμής.

## Εγκατάσταση

Από τον φάκελο payments_app/:

```bash
pip install -r requirements.txt
```

Το requirements.txt περιέχει τουλάχιστον:

```
streamlit
pandas
```

## Εκτέλεση

Από τον φάκελο project-root/ ή payments_app/:

```bash
cd payments_app
streamlit run payments.py
```

Θα εμφανιστεί ένα URL (συνήθως http://localhost:8501) όπου τρέχει η εφαρμογή.

## Ρόλος γονέα (Parents view)

Στην καρτέλα «Γονείς - Δήλωση & Πληρωμή»:

Ο χρήστης βλέπει:

πόσες θέσεις είναι πληρωμένες,

πόσες είναι δεσμευμένες χωρίς πληρωμή,

πόσες είναι ελεύθερες,

πόσες έχουν ζητηθεί σε λίστα αναμονής,

μια μπάρα προόδου (πόσο έχει γεμίσει η αίθουσα).

Συμπληρώνει το email του:

αν υπάρχει στο interest.csv → θεωρείται ότι είχε δηλώσει αρχικό ενδιαφέρον (category = interest),

αν δεν υπάρχει → μπορεί να δηλώσει συμμετοχή στη λίστα αναμονής (category = waitlist).

Αν είναι στην κατηγορία interest:

βλέπει την αρχική δήλωση (όνομα, τμήμα, αριθμό εισιτηρίων),

μπορεί να προσαρμόσει τα εισιτήρια (όχι πάνω από όσα είχε αρχικά δηλώσει),

λαμβάνει κωδικό πληρωμής (π.χ. EVT-005) και το ακριβές ποσό.

Αν είναι στην κατηγορία waitlist (δεν είχε αρχικά δηλώσει ενδιαφέρον):

δεν εμφανίζεται ποσό πληρωμής,

η δήλωσή του καταγράφεται στη λίστα αναμονής,

παίρνει αριθμό προτεραιότητας (priority_number) στη waitlist (π.χ. #3).

## Ρόλος διαχειριστή (Admin view)

Στην καρτέλα «Διαχειριστής - Έλεγχος & Καταχώριση Πληρωμών», με password (π.χ. syllogos2025):

Προβολή συνοπτικών μετρικών:

συνολικές θέσεις,

δεσμευμένες θέσεις (σύνολο),

πληρωμένες (paid),

σε εκκρεμότητα (pending),

ζητούμενες σε λίστα αναμονής.

Φίλτρα και αναζήτηση:

ανά κατάσταση (pending, paid, waitlist),

ανά κατηγορία (interest, waitlist),

αναζήτηση με email, όνομα γονέα, κωδικό πληρωμής.

Μαρκάρισμα πληρωμής:

με βάση τον payment_code (π.χ. EVT-003),

ενημέρωση σε payment_status = "paid" για κανονικές κρατήσεις.

Εξαγωγή όλων των δεδομένων σε CSV (payments_export.csv).

Προβολή λίστας αναμονής ταξινομημένης:

κατά priority_number,

και στη συνέχεια κατά timestamp.

## Αριθμός προτεραιότητας (Priority number)

Για εγγραφές σε λίστα αναμονής:

Στην πρώτη εγγραφή κάποιου email σε waitlist, του δίνεται αυτόματα
ένας αριθμός σειράς (priority_number) ανάλογα με το πόσοι έχουν ήδη μπει.

Αν ο ίδιος χρήστης τροποποιήσει αργότερα τα στοιχεία του, κρατάει τον ίδιο αριθμό.

Ο αριθμός προτεραιότητας εμφανίζεται:

στον ίδιο τον γονιό μετά την καταχώριση,

και στο admin view στη στήλη priority_number.

## Αναφορά στο GitHub repository

Η εφαρμογή υλοποιήθηκε και εξελίχθηκε με βάση τον κώδικα του:

[GitHub repo](https://github.com/gfragi/book_seat_pay)
